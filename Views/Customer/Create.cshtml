@model List<Customers>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="card">
    <div class="card-header header-elements-inline">
        <h5 class="card-title"><i class="icon-person mr-1"></i>Create Customer</h5>
        <div class="header-elements">
            <div class="list-icons">
                <a class="list-icons-item" data-action="reload"></a>
                <a class="list-icons-item" data-action="remove"></a>
            </div>
        </div>
    </div>
    <div class="card-body">
        <form asp-controller="Customer" asp-action="Create" method="post">
            <table class="table" id="participantTable">
                <thead>
                    <tr>
                        <th>Customer Name</th>
                        <th>Address</th>
                        <th>Code</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Outlet Name</th>
                        <th class="text-center">Action</th>
                    </tr>
                </thead>
                <tr class="participantRow">
                    @{
                        int flag = 0;
                        foreach (Customers item in Model)
                        {
                            <td>
                                <input name="item[@flag].CustomerName" type="text" placeholder="Customer Name" class="form-control required-entry">
                            </td>
                            <td>
                                <input name="item[@flag].Address" type="text" placeholder="Address" class="form-control required-entry">
                            </td>
                            <td>
                                <input name="item[@flag].Code" type="text" placeholder="Code" class="form-control required-entry">
                            </td>
                            <td>
                                <div class="input-group">
                                    <span class="input-group-prepend">
                                        <span class="input-group-text"><i class="icon-calendar22"></i></span>
                                    </span>
                                    <input type="text" name="item[@flag].StartDate" class="form-control daterange-single" value="">
                                </div>

                            </td>
                            <td>
                                <div class="input-group">
                                    <span class="input-group-prepend">
                                        <span class="input-group-text"><i class="icon-calendar22"></i></span>
                                    </span>
                                    <input type="text" name="item[@flag].EndDate" class="form-control daterange-single" placeholder="Start Date" value="">
                                </div>
                            </td>
                            <td>
                                <select class="form-control" name="item[@flag].OutletID" asp-items="@(new SelectList(item.OutletList, "OutletID", "OutletName"))">
                                    <option value="">Select Outlet</option>
                                </select>
                            </td>
                            <td class="text-center"><button class="btn btn-danger remove" type="button">Remove</button></td>
                            flag++;
                        }
                    }
                </tr>
                <tr id="addButtonRow">
                    <td>
                        <button class="btn btn-large btn-success add" type="button">Add</button>
                        <button class="btn btn-large btn-primary save" type="submit">Save</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>

@section Scripts{
    <script type="text/javascript">
        $(document).ready(function () {

            /* Variables */
            var p = $("#participants").val();
            var row = $(".participantRow");

            /* Functions */
            function getP() {
                p = $("#participants").val();
            }

            function addRow() {
                row.clone(true, true).appendTo("#participantTable");
            }

            function removeRow(button) {
                button.closest("tr").remove();
            }
            /* Doc ready */
            $(".add").on('click', function () {
                getP();
                if ($("#participantTable tr").length < 17) {
                    addRow();
                    var i = Number(p) + 1;
                    $("#participants").val(i);
                }
                $(this).closest("tr").appendTo("#participantTable");
                if ($("#participantTable tr").length === 3) {
                    $(".remove").hide();
                } else {
                    $(".remove").show();
                }
            });
            $(".remove").on('click', function () {
                getP();
                if ($("#participantTable tr").length === 3) {
                    //alert("Can't remove row.");
                    $(".remove").hide();
                } else if ($("#participantTable tr").length - 1 == 3) {
                    $(".remove").hide();
                    removeRow($(this));
                    var i = Number(p) - 1;
                    $("#participants").val(i);
                } else {
                    removeRow($(this));
                    var i = Number(p) - 1;
                    $("#participants").val(i);
                }
            });
            $("#participants").change(function () {
                var i = 0;
                p = $("#participants").val();
                var rowCount = $("#participantTable tr").length - 2;
                if (p > rowCount) {
                    for (i = rowCount; i < p; i += 1) {
                        addRow();
                    }
                    $("#participantTable #addButtonRow").appendTo("#participantTable");
                } else if (p < rowCount) {
                }
            });
        });


    </script>
}
